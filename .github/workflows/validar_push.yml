name: Push Branch Validator

on:
  push:
    branches:
      - '!main'      # Excluye la rama 'main'
      - '!master'    # Excluye la rama 'master'

jobs:
  validate-branch-name:
    runs-on: ubuntu-latest
    steps:
      - name: Check Branch Prefix
        run: |
          # Obtenemos el nombre de la rama desde la variable de contexto
          BRANCH_NAME="${{ github.ref_name }}"
          
          echo "Validando el nombre de la rama: $BRANCH_NAME"
          
          # Verificamos si el nombre cumple la convención
          if echo "$BRANCH_NAME" | grep -Eq '^(feature|bugfix|hotfix)/'; then
            echo "¡Nombre de rama válido! ($BRANCH_NAME)"
            exit 0 # El workflow pasa
          else
            echo "--- ERROR ---"
            echo "El nombre de la rama '$BRANCH_NAME' NO CUMPLE la convención."
            echo "Debe empezar con 'feature/', 'bugfix/', o 'hotfix/'."
            exit 1 # Hacemos que el workflow falle
          fi